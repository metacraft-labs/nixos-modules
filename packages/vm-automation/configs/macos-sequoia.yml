# Copyright 2026 Schelling Point Labs Inc
# SPDX-License-Identifier: AGPL-3.0-only

# Simplified macOS Sequoia Setup Assistant Configuration
# This is a minimal example for testing the automation engine
# For full automation, see: vendor/vm-research/cua/libs/lume/resources/unattended-sequoia.yml

boot_wait: 30

boot_commands:
  # Wait for greeting screen
  - '<delay 5>'
  - '<space>'
  - '<delay 2>'

  # Language selection
  - "<wait 'English', timeout=120>"
  - "<type 'English'>"
  - '<delay 1>'
  - '<enter>'
  - '<delay 2>'

  # Country/Region selection
  - "<wait 'Country or Region'>"
  - '<click_at 960,900>'
  - "<type 'United States'>"
  - '<enter>'
  - "<click 'Continue'>"
  - '<delay 2>'

  # Create account
  - "<wait 'Create a Mac Account'>"
  - "<click 'Full Name'>"
  - "<type 'lume'>"
  - '<tab>'
  - '<tab>'
  - "<type 'lume'>"
  - '<tab>'
  - "<type 'lume'>"
  - "<click 'Continue'>"
  - '<delay 2>'

  # Terms and Conditions - use index=-1 for last "Agree" button
  - "<wait 'Terms and Conditions'>"
  - "<click 'Agree', index=-1>"
  - "<wait 'I have read and agree'>"
  - "<click 'Agree', index=0>"
  - '<delay 2>'

  # Complete setup
  - "<wait 'Welcome to Mac'>"
  - '<space>'
  - '<delay 30>'

  # Enable SSH via Terminal
  - '<click_at 960,540>'
  - '<cmd+space>'
  - "<type 'Terminal'>"
  - '<enter>'
  - '<delay 3>'
  - "<type 'sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist'>"
  - '<enter>'
  - "<type 'lume'>"
  - '<enter>'
  - '<delay 2>'
  - '<cmd+q>'

health_check:
  type: ssh
  user: lume
  password: lume
  timeout: 30
  retries: 5
  retry_delay: 10
