# Copyright 2026 Schelling Point Labs Inc
# SPDX-License-Identifier: AGPL-3.0-only

# Simplified macOS Sequoia Setup Assistant Configuration
# This is a minimal example for testing the automation engine
# For full automation, see: vendor/vm-research/cua/libs/lume/resources/unattended-sequoia.yml

boot_wait: 30

boot_commands:
  # Wait for greeting screen
  - delay: 5
  - key: space
  - delay: 2

  # Language selection
  - wait:
      text: 'English'
      timeout: 120
  - type: 'English'
  - delay: 1
  - key: enter
  - delay: 2

  # Country/Region selection
  - wait:
      text: 'Country or Region'
      timeout: 120
  - click_at:
      x: 960
      y: 900
  - type: 'United States'
  - key: enter
  - click: 'Continue'
  - delay: 2

  # Create account
  - wait:
      text: 'Create a Mac Account'
      timeout: 120
  - click: 'Full Name'
  - type: 'lume'
  - key: tab
  - key: tab
  - type: 'lume'
  - key: tab
  - type: 'lume'
  - click: 'Continue'
  - delay: 2

  # Terms and Conditions - use index=-1 for last "Agree" button
  - wait:
      text: 'Terms and Conditions'
      timeout: 120
  - click:
      text: 'Agree'
      index: -1
  - wait:
      text: 'I have read and agree'
      timeout: 120
  - click:
      text: 'Agree'
      index: 0
  - delay: 2

  # Complete setup
  - wait:
      text: 'Welcome to Mac'
      timeout: 120
  - key: space
  - delay: 30

  # Enable SSH via Terminal
  - click_at:
      x: 960
      y: 540
  - hotkey:
      modifiers: [cmd]
      key: space
  - type: 'Terminal'
  - key: enter
  - delay: 3
  - type: 'sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist'
  - key: enter
  - type: 'lume'
  - key: enter
  - delay: 2
  - hotkey:
      modifiers: [cmd]
      key: q

health_check:
  type: ssh
  user: lume
  password: lume
  timeout: 30
  retries: 5
  retry_delay: 10
